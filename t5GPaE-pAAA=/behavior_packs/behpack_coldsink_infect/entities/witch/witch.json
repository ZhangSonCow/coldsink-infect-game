{
    "format_version": "1.16.0",
    "minecraft:entity": {
      "description": {
        "identifier": "coldsink:witch_0",
        "is_spawnable": true,
        "is_summonable": true,
        "is_experimental": false,
        "animations": {
          "c": "controller.animation.witch_ai.func",
          "damage": "controller.animation.witch_ai_damage.func",
          "ctrl.witch_ai_skill_timer": "controller.animation.witch_ai_skill_timer.func",
          "witch_ai_skill_timer": "animation.witch_ai_skill_timer.func"
        },
        "scripts": {
          "animate": [
            "c",
            "damage",
            "ctrl.witch_ai_skill_timer"
          ]
        }
      },
  
      "component_groups": {
        "godie": {
          "minecraft:instant_despawn": {}
        },
        "sign": {
          "minecraft:is_ignited": {}
        },
        "walk": {
          "minecraft:navigation.walk": {
            "can_walk": true,
            "can_pass_doors": true,
            "can_break_doors": true,
            "is_amphibious": true,
            "avoid_damage_blocks": false
          }
        },
        "climb": {
          "minecraft:navigation.climb": {
            "can_path_over_water": true,
            "blocks_to_avoid": [
              "minecraft:barrier"
            ]
          },
          "minecraft:behavior.leap_at_target": {
            "priority": 1,
            "must_be_on_ground": true,
            "set_persistent": true,
            "target_dist": 32,
            "yd": 0.5
          },
          "minecraft:timer": {
            "time": [8, 12],
            "time_down_event": {
              "event": "skill",
              "target": "self"
            }
          }
        },
  
        "damage_1": {
          "minecraft:attack": {
            "damage": 8
          }
        },
        "damage_2": {
          "minecraft:attack": {
            "damage": 9
          }
        },
        "damage_3": {
          "minecraft:attack": {
            "damage": 11
          }
        },
        "damage_4": {
          "minecraft:attack": {
            "damage": 14
          }
        },
        "damage_5": {
          "minecraft:attack": {
            "damage": 18
          }
        },
        "attack_mode": {
          "minecraft:behavior.nearest_attackable_target": {
            "priority": 2,
            "reselect_targets": true,
            "entity_types": [
              {
                "filters": {
                  "all_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "operator": "=",
                      "value": "player"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "operator": "!=",
                      "value": "monster"
                    },
                    {
                      "test": "is_family",
                      "subject": "other",
                      "operator": "!=",
                      "value": "tool"
                    },
                    {
                      "test": "has_tag",
                      "subject": "other",
                      "operator": "!=",
                      "value": "no_any_hurt"
                    }
                  ]
                },
                "max_dist": 48
              }
            ],
            "must_see": true
          },
          "minecraft:collision_box": {
            "width": 0.55,
            "height": 1.9
          },
          "minecraft:on_target_acquired": {
            "event": "has_target",
            "target": "self"
          },
          "minecraft:on_target_escape": {
            "event": "lost_target",
            "target": "self"
          },
          "minecraft:behavior.random_stroll": {
            "priority": 6,
            "speed_multiplier": 0.8
          },
          "minecraft:behavior.random_look_around": {
            "priority": 7
          },
          "minecraft:behavior.look_at_player": {
            "priority": 7,
            "look_distance": 6,
            "probability": 0.02
          },
          "minecraft:behavior.delayed_attack": {
            "priority": 1,
            "attack_once": false,
            "track_target": true,
            "require_complete_path": false,
            "random_stop_interval": 0,
            "reach_multiplier": 5,
            "speed_multiplier": 1,
            "attack_duration": 0.8,
            "hit_delay_pct": 0.5
          },
          "minecraft:damage_sensor": {
            "triggers": [
              {
                "on_damage": {
                  "filters": [
                    {
                      "test":"has_damage",
                      "value":"fatal",
                      "operator": "!="
                    }
                  ],
                  "event": "hurting",
                  "target": "self"
                }
              },
              {
                "cause": "fall",
                "deals_damage": false
              }
            ]
          }
        },
        "cry_mode": {
          "minecraft:is_tamed": {},
          "minecraft:collision_box": {
            "width": 0.55,
            "height": 0.8
          },
          "minecraft:damage_sensor": {
            "triggers": [
              {
                "on_damage": {
                  "event": "become_angry",
                  "target": "self"
                }
              },
              {
                "cause": "all",
                "deals_damage": false
              }
            ]
          },
          "minecraft:target_nearby_sensor": {
            "inside_range": 10,
            "must_see": true,
            "on_inside_range": {
              "event": "stay_around"
            },
            "on_outside_range": {
              "event": "leave_around"
            },
            "outside_range": 11
          },
          "minecraft:on_hurt_by_player": {
            "event": "become_angry"
          }
        },
        "stand_cry_mode": {
          "minecraft:is_stunned": {},
          "minecraft:collision_box": {
            "width": 0.55,
            "height": 1.8
          },
          "minecraft:navigation.walk": {
            "can_walk": true,
            "can_pass_doors": true,
            "can_break_doors": true,
            "is_amphibious": true,
            "avoid_damage_blocks": false
          },
          "minecraft:behavior.random_stroll": {
            "priority": 6,
            "speed_multiplier": 0.4
          },
          "minecraft:behavior.random_look_around": {
            "priority": 7
          },
          "minecraft:behavior.look_at_player": {
            "priority": 7,
            "look_distance": 6,
            "probability": 0.02
          },
          "minecraft:damage_sensor": {
            "triggers": [
              {
                "on_damage": {
                  "event": "become_angry",
                  "target": "self"
                }
              },
              {
                "cause": "all",
                "deals_damage": false
              }
            ]
          },
          "minecraft:target_nearby_sensor": {
            "inside_range": 10,
            "must_see": true,
            "on_inside_range": {
              "event": "stay_around"
            },
            "on_outside_range": {
              "event": "leave_around"
            },
            "outside_range": 11
          },
          "minecraft:on_hurt_by_player": {
            "event": "become_angry"
          }
        },
        "getting_angry": {
          "minecraft:ageable": {
            "duration": 8,
            "grow_up": {
              "event": "become_angry",
              "target": "self"
            }
          }
        },
        "get_box_mode": {
          "minecraft:behavior.nearest_attackable_target": {
            "priority": 2,
            "reselect_targets": true,
            "entity_types": [
              {
                "filters": {
                  "all_of": [
                    {
                      "test": "is_family",
                      "subject": "other",
                      "operator": "=",
                      "value": "final_box_red"
                    }
                  ]
                },
                "max_dist": 48
              }
            ],
            "must_see": true
          }
        },

        "skill": {
          "minecraft:is_sheared": {}
        }
      },
  
      "components": {
        "minecraft:nameable": {
          "always_show": false,
          "allow_name_tag_renaming": true
        },
        "minecraft:type_family": {
          "family": [ "mob", "sdc", "monster", "special", "witch", "boss", "normal_boss", "ai" ]
        },
        "minecraft:loot": {
          "table": "loot_tables/entities/witch.loot.json"
        },
        "minecraft:health": {
          "value": 100,
          "max": 100
        },
        "minecraft:movement": {
          "value": 0.45
        },
        "minecraft:knockback_resistance": {
          "value": 1.0
        },
        "minecraft:follow_range": {
          "value": 64
        },
        "minecraft:boss": {
          "should_darken_sky": false,
          "hud_range": 16,
          "name": "Witch"
        },
        "minecraft:jump.static": {},
        "minecraft:physics": {},
        "minecraft:movement.basic": {},
  
        "minecraft:behavior.hurt_by_target": {
          "priority": 0,
          "max_dist": 64,
          "entity_types": {
            "filters": {
              "all_of": [
                {
                  "test": "is_family",
                  "subject": "other",
                  "operator": "!=",
                  "value": "tool"
                }
              ]
            }
          }
        }
      },
  
      "events": {
        "minecraft:entity_spawned": {
          "add": {
            "component_groups": [
              "cry_mode"
            ]
          },
          "queue_command": {
            "command": [
              "tag @s add is_witch",
              "scoreboard objectives add wp_random dummy wp_random",
              "tag @s add witch_idle",
              "event entity @a[r=48] witch_bgm"
            ]
          }
        },
        "stand": {
          "add": {
            "component_groups": [
              "stand_cry_mode"
            ]
          },
          "queue_command": {
            "command": [
              "tag @s add is_witch",
              "scoreboard objectives add wp_random dummy wp_random",
              "tag @s add witch_idle",
              "event entity @a[r=48] witch_bgm"
            ]
          }
        },
        "become_angry": {
          "add": {
            "component_groups": [
              "walk",
              "attack_mode",
              "damage_1"
            ]
          },
          "remove": {
            "component_groups": [
              "cry_mode",
              "stand_cry_mode",
              "getting_angry"
            ]
          },
          "queue_command": {
            "command": [
              "execute @s[tag=!is_angry] ~~~ title @a[r=10] actionbar §dWitch 被惊扰了！",
              "effect @s[tag=!is_angry] speed 8 2 true",
              "effect @s[tag=!is_angry] strength 8 1 true",
              "tag @s add is_angry",
              "scoreboard players random @s wp_random 1 2",
              "execute @s[scores={wp_random=1}] ~~~ playsound witch.skill @a ~~~",
              "execute @s[scores={wp_random=1}] ~~~ playsound witch.alarm @a ~~~"
            ]
          }
        },
        "stay_around": {
          "add": {
            "component_groups": [
              "getting_angry"
            ]
          },
          "queue_command": {
            "command": [
              "scoreboard players random @s wp_random 1 3",
              "execute @s[scores={wp_random=1}] ~~~ playsound witch.cry_1 @a ~~~",
              "execute @s[scores={wp_random=2}] ~~~ playsound witch.cry_2 @a ~~~",
              "execute @s[scores={wp_random=3}] ~~~ playsound witch.cry_3 @a ~~~"
            ]
          }
        },
        "leave_around": {
          "remove": {
            "component_groups": [
              "getting_angry"
            ]
          },
          "queue_command": {
            "command": [
              "scoreboard players random @s wp_random 1 3",
              "execute @s[scores={wp_random=1}] ~~~ playsound witch.cry_1 @a ~~~",
              "execute @s[scores={wp_random=2}] ~~~ playsound witch.cry_2 @a ~~~",
              "execute @s[scores={wp_random=3}] ~~~ playsound witch.cry_3 @a ~~~"
            ]
          }
        },
        "has_target": {
          "remove": {
            "component_groups": [
              "walk"
            ]
          },
          "add": {
            "component_groups": [
              "climb"
            ]
          }
        },
        "lost_target": {
          "remove": {
            "component_groups": [
              "climb"
            ]
          },
          "add": {
            "component_groups": [
              "walk"
            ]
          }
        },
        "skill": {
          "add": {
            "component_groups": [
              "skill"
            ]
          },
          "queue_command": {
            "command": [
              "effect @s resistance 5 10 true",
              "effect @s speed 5 1 true",
              "playsound witch.skill @a ~~~"
            ]
          }
        },
        "skill_over": {
          "remove": {
            "component_groups": [
              "skill"
            ]
          }
        },
        "hurting":{
          "queue_command": {
            "command": [
              "scoreboard players random @s[tag=!sound_interval] wp_random 1 3",
  
              "execute @s[tag=!sound_interval,scores={wp_random=1}] ~~~ playsound witch.hurt_1 @a ~~~",
              "execute @s[tag=!sound_interval,scores={wp_random=2}] ~~~ playsound witch.hurt_2 @a ~~~",
              "execute @s[tag=!sound_interval,scores={wp_random=3}] ~~~ playsound witch.hurt_3 @a ~~~",
  
              "scoreboard players reset @s[tag=!sound_interval] idle_time",
              "tag @s[tag=!sound_interval] add sound_interval",

              "event entity @s become_angry"
            ]
          }
        },
        "damage_1": {
          "add": {
            "component_groups": [
              "damage_1"
            ]
          },
          "remove": {
            "component_groups": [
              "damage_2",
              "damage_3",
              "damage_4",
              "damage_5"
            ]
          }
        },
        "damage_2": {
          "add": {
            "component_groups": [
              "damage_2"
            ]
          },
          "remove": {
            "component_groups": [
              "damage_1",
              "damage_3",
              "damage_4",
              "damage_5"
            ]
          }
        },
        "damage_3": {
          "add": {
            "component_groups": [
              "damage_3"
            ]
          },
          "remove": {
            "component_groups": [
              "damage_1",
              "damage_2",
              "damage_4",
              "damage_5"
            ]
          }
        },
        "damage_4": {
          "add": {
            "component_groups": [
              "damage_4"
            ]
          },
          "remove": {
            "component_groups": [
              "damage_1",
              "damage_2",
              "damage_3",
              "damage_5"
            ]
          }
        },
        "damage_5": {
          "add": {
            "component_groups": [
              "damage_5"
            ]
          },
          "remove": {
            "component_groups": [
              "damage_1",
              "damage_2",
              "damage_3",
              "damage_4"
            ]
          }
        },
        "godie": {
          "add": {
            "component_groups": [
              "godie"
            ]
          }
        }
      }
    }
  }
  