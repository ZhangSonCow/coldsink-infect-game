{
  "format_version": "1.16.0",
  "minecraft:entity": {
    "description": {
      "identifier": "coldsink:charger_charge",
      "is_spawnable": false,
      "is_summonable": true,
      "is_experimental": false
    },
    "component_groups": {
      "godie": {
        "minecraft:instant_despawn": {}
      }
    },

    "components": {
      "minecraft:damage_sensor": {
        "triggers": {
          "cause": "all",
          "deals_damage": false
        }
      },
      "minecraft:type_family": {
        "family": [ "tool" ]
      },
      "minecraft:ageable": {
        "duration": 4.0,
        "grow_up": {
          "event": "godie"
        }
      },
      "minecraft:timer": {
        "time": 0.01,
        "time_down_event": {
          "target": "self",
          "event": "carry"
        }
      },
      "minecraft:collision_box": {
        "width": 1.0,
        "height": 2.15
      },
      "minecraft:physics": {}

      //behavivors

    },

    "events": {
      "minecraft:entity_spawned": {
        "queue_command": {
          "command": [
            "tp @s ~~~ facing @p[family=charger]",
            "tag @s add neutral",
            "scoreboard players operation @s charger_time = charger_count charger_time"
          ]
        }
      },
      "carry": {
        "queue_command": {
          "command": [
            "event entity @s[tag=maper] carry_map",
            "event entity @s[tag=!maper] carry_mod"
          ]
        }
      },
      "carry_map": {
        "queue_command": {
          "command": [
            "scoreboard players set @s bool 0",
            "execute @p[family=charger,r=5] ~~~ scoreboard players set @e[type=coldsink:charger_charge,tag=maper,c=1] bool 1",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ~~-1~ water -1 event entity @s godie",

            "scoreboard players operation @e[family=charger,tag=charger_charging] charger_check = @s charger_time",
            "execute @e[family=charger,tag=charger_charging] ~~~ scoreboard players operation @s charger_check -= @s charger_time",
            "tp @e[family=charger,tag=charger_charging,scores={charger_check=0},c=1] ^^^1.5",

            "execute @e[family=player,family=!tool,type=!item,tag=!neutral,tag=!charger_get,r=2.4] ~~~ playsound reward @p[family=charger]",
            "execute @e[family=player,family=!tool,type=!item,tag=!neutral,tag=!charger_get,r=2.4] ~~~ title @p[family=charger] actionbar §7冲撞命中目标！",
            "scoreboard players operation @e[family=player,family=!tool,type=!item,tag=!neutral,tag=!charger_get,r=2.4] charger_time = @s charger_time",
            "tag @e[family=player,family=!tool,type=!item,tag=!neutral,r=2.4] add charger_get",
            "execute @e[tag=charger_get,r=8] ~~~ tp @s @e[type=coldsink:charger_charge,tag=maper,c=1]",
            "execute @s ~~~ detect ~~-0.5~ air -1 tp @s ~~-0.5~",
            
            "scoreboard players set @s bool 0",
            "execute @s ~~~ detect ~~~ air -1 execute @s ~~~ detect ^^^-0.25 air -1 execute @s ~~~ detect ^^^-0.5 air -1 execute @s ~~~ detect ^^^-0.75 air -1 execute @s ~~~ detect ^^^-1 air -1 execute @s ~~~ detect ^^^0.25 air -1 execute @s ~~~ detect ^^^0.5 air -1 execute @s ~~~ detect ^^^0.75 air -1 execute @s ~~~ detect ^^^1 air -1 execute @s ~~~ detect ^0.25^^ air -1 execute @s ~~~ detect ^-0.25^^ air -1 scoreboard players set @s bool 1",
            "execute @s[scores={bool=0}] ~~~ detect ^^1^-0.25 air -1 execute @s ~~~ detect ^^2^-0.25 air -1 scoreboard players set @s bool 2",
            "tag @s[scores={bool=2}] add charger_up",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ^^^-0.25 concrete -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^-1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 air -1 tp @s ^^^-0.25 ~ 0",

            "scoreboard players set @s bool 0",
            "execute @s ~~~ detect ~~~ air -1 execute @s ~~~ detect ^^^-0.25 air -1 execute @s ~~~ detect ^^^-0.5 air -1 execute @s ~~~ detect ^^^-0.75 air -1 execute @s ~~~ detect ^^^-1 air -1 execute @s ~~~ detect ^^^0.25 air -1 execute @s ~~~ detect ^^^0.5 air -1 execute @s ~~~ detect ^^^0.75 air -1 execute @s ~~~ detect ^^^1 air -1 execute @s ~~~ detect ^0.25^^ air -1 execute @s ~~~ detect ^-0.25^^ air -1 scoreboard players set @s bool 1",
            "execute @s[scores={bool=0}] ~~~ detect ^^1^-0.25 air -1 execute @s ~~~ detect ^^2^-0.25 air -1 scoreboard players set @s bool 2",
            "tag @s[scores={bool=2}] add charger_up",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ^^^-0.25 concrete -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^-1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 air -1 tp @s ^^^-0.25 ~ 0",

            "scoreboard players set @s bool 0",
            "execute @s ~~~ detect ~~~ air -1 execute @s ~~~ detect ^^^-0.25 air -1 execute @s ~~~ detect ^^^-0.5 air -1 execute @s ~~~ detect ^^^-0.75 air -1 execute @s ~~~ detect ^^^-1 air -1 execute @s ~~~ detect ^^^0.25 air -1 execute @s ~~~ detect ^^^0.5 air -1 execute @s ~~~ detect ^^^0.75 air -1 execute @s ~~~ detect ^^^1 air -1 execute @s ~~~ detect ^0.25^^ air -1 execute @s ~~~ detect ^-0.25^^ air -1 scoreboard players set @s bool 1",
            "execute @s[scores={bool=0}] ~~~ detect ^^1^-0.25 air -1 execute @s ~~~ detect ^^2^-0.25 air -1 scoreboard players set @s bool 2",
            "tag @s[scores={bool=2}] add charger_up",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ^^^-0.25 concrete -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^-1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 air -1 tp @s ^^^-0.25 ~ 0",

            "scoreboard players set @s bool 0",
            "execute @s ~~~ detect ~~~ air -1 execute @s ~~~ detect ^^^-0.25 air -1 execute @s ~~~ detect ^^^-0.5 air -1 execute @s ~~~ detect ^^^-0.75 air -1 execute @s ~~~ detect ^^^-1 air -1 execute @s ~~~ detect ^^^0.25 air -1 execute @s ~~~ detect ^^^0.5 air -1 execute @s ~~~ detect ^^^0.75 air -1 execute @s ~~~ detect ^^^1 air -1 execute @s ~~~ detect ^0.25^^ air -1 execute @s ~~~ detect ^-0.25^^ air -1 scoreboard players set @s bool 1",
            "execute @s[scores={bool=0}] ~~~ detect ^^1^-0.25 air -1 execute @s ~~~ detect ^^2^-0.25 air -1 scoreboard players set @s bool 2",
            "tag @s[scores={bool=2}] add charger_up",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ^^^-0.25 concrete -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^-1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 air -1 tp @s ^^^-0.25 ~ 0",

            "tp @s[tag=charger_up] ~~1~",
            "tag @s remove charger_up"
          ]
        }
      },
      "carry_mod": {
        "queue_command": {
          "command": [
            "scoreboard players set @s bool 0",
            "execute @p[family=charger,r=5] ~~~ scoreboard players set @e[type=coldsink:charger_charge,tag=!maper,c=1] bool 1",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ~~-1~ water -1 event entity @s godie",

            "scoreboard players operation @e[family=charger,tag=charger_charging] charger_check = @s charger_time",
            "execute @e[family=charger,tag=charger_charging] ~~~ scoreboard players operation @s charger_check -= @s charger_time",
            "tp @e[family=charger,tag=charger_charging,scores={charger_check=0},c=1] ^^^1.5",

            "execute @e[family=!charger,family=!tool,tag=!charger_get,r=2.4] ~~~ playsound reward @p[family=charger]",
            "execute @e[family=!charger,family=!tool,tag=!charger_get,r=2.4] ~~~ title @p[family=charger] actionbar §7冲撞命中目标！",
            "scoreboard players operation @e[family=!charger,family=!tool,tag=!charger_get,r=2.4] charger_time = @s charger_time",
            "tag @e[family=!charger,family=!tool,r=2.4] add charger_get",
            "execute @e[tag=charger_get,r=8] ~~~ tp @s @e[type=coldsink:charger_charge,tag=!maper,c=1]",
            "execute @s ~~~ detect ~~-0.5~ air -1 tp @s ~~-0.5~",
            
            "scoreboard players set @s bool 0",
            "execute @s ~~~ detect ~~~ air -1 execute @s ~~~ detect ^^^-0.25 air -1 execute @s ~~~ detect ^^^-0.5 air -1 execute @s ~~~ detect ^^^-0.75 air -1 execute @s ~~~ detect ^^^-1 air -1 execute @s ~~~ detect ^^^0.25 air -1 execute @s ~~~ detect ^^^0.5 air -1 execute @s ~~~ detect ^^^0.75 air -1 execute @s ~~~ detect ^^^1 air -1 execute @s ~~~ detect ^0.25^^ air -1 execute @s ~~~ detect ^-0.25^^ air -1 scoreboard players set @s bool 1",
            "execute @s[scores={bool=0}] ~~~ detect ^^1^-0.25 air -1 execute @s ~~~ detect ^^2^-0.25 air -1 scoreboard players set @s bool 2",
            "tag @s[scores={bool=2}] add charger_up",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ^^^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^-1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 air -1 tp @s ^^^-0.25 ~ 0",

            "scoreboard players set @s bool 0",
            "execute @s ~~~ detect ~~~ air -1 execute @s ~~~ detect ^^^-0.25 air -1 execute @s ~~~ detect ^^^-0.5 air -1 execute @s ~~~ detect ^^^-0.75 air -1 execute @s ~~~ detect ^^^-1 air -1 execute @s ~~~ detect ^^^0.25 air -1 execute @s ~~~ detect ^^^0.5 air -1 execute @s ~~~ detect ^^^0.75 air -1 execute @s ~~~ detect ^^^1 air -1 execute @s ~~~ detect ^0.25^^ air -1 execute @s ~~~ detect ^-0.25^^ air -1 scoreboard players set @s bool 1",
            "execute @s[scores={bool=0}] ~~~ detect ^^1^-0.25 air -1 execute @s ~~~ detect ^^2^-0.25 air -1 scoreboard players set @s bool 2",
            "tag @s[scores={bool=2}] add charger_up",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ^^^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^-1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 air -1 tp @s ^^^-0.25 ~ 0",

            "scoreboard players set @s bool 0",
            "execute @s ~~~ detect ~~~ air -1 execute @s ~~~ detect ^^^-0.25 air -1 execute @s ~~~ detect ^^^-0.5 air -1 execute @s ~~~ detect ^^^-0.75 air -1 execute @s ~~~ detect ^^^-1 air -1 execute @s ~~~ detect ^^^0.25 air -1 execute @s ~~~ detect ^^^0.5 air -1 execute @s ~~~ detect ^^^0.75 air -1 execute @s ~~~ detect ^^^1 air -1 execute @s ~~~ detect ^0.25^^ air -1 execute @s ~~~ detect ^-0.25^^ air -1 scoreboard players set @s bool 1",
            "execute @s[scores={bool=0}] ~~~ detect ^^1^-0.25 air -1 execute @s ~~~ detect ^^2^-0.25 air -1 scoreboard players set @s bool 2",
            "tag @s[scores={bool=2}] add charger_up",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ^^^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^-1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 air -1 tp @s ^^^-0.25 ~ 0",

            "scoreboard players set @s bool 0",
            "execute @s ~~~ detect ~~~ air -1 execute @s ~~~ detect ^^^-0.25 air -1 execute @s ~~~ detect ^^^-0.5 air -1 execute @s ~~~ detect ^^^-0.75 air -1 execute @s ~~~ detect ^^^-1 air -1 execute @s ~~~ detect ^^^0.25 air -1 execute @s ~~~ detect ^^^0.5 air -1 execute @s ~~~ detect ^^^0.75 air -1 execute @s ~~~ detect ^^^1 air -1 execute @s ~~~ detect ^0.25^^ air -1 execute @s ~~~ detect ^-0.25^^ air -1 scoreboard players set @s bool 1",
            "execute @s[scores={bool=0}] ~~~ detect ^^1^-0.25 air -1 execute @s ~~~ detect ^^2^-0.25 air -1 scoreboard players set @s bool 2",
            "tag @s[scores={bool=2}] add charger_up",
            "event entity @s[scores={bool=0}] godie",
            "execute @s ~~~ detect ^^^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^-1^-0.25 barrier -1 event entity @s godie",
            "execute @s ~~~ detect ^^^-0.25 air -1 tp @s ^^^-0.25 ~ 0",

            "tp @s[tag=charger_up] ~~1~",
            "tag @s remove charger_up"
          ]
        }
      },
      "godie": {
        "queue_command": {
          "command": [
            "event entity @s[tag=maper] over_map",
            "event entity @s[tag=!maper] over_mod"
          ]
        }
      },
      "over_map": {
        "queue_command": {
          "command": [
            "title @p[family=charger] actionbar §7冲撞结束！",
            "tp @p[family=charger] ^^^1.5",
            "tp @e[tag=charger_get,r=3.2] ^^^1.5",

            "scoreboard players operation @e[family=player,family=!tool,type=!item,tag=!neutral] charger_check = @s charger_time",
            "execute @e[family=player,family=!tool,type=!item,tag=!neutral] ~~~ scoreboard players operation @s charger_check -= @s charger_time",
            "tag @e[family=player,family=!tool,type=!item,tag=!neutral,scores={charger_check=0}] remove charger_get",
            "scoreboard players reset @e[family=player,family=!tool,type=!item,tag=!neutral,scores={charger_check=0}] charger_time",
            "scoreboard players operation @e[family=charger] charger_check = @s charger_time",
            "execute @e[family=charger] ~~~ scoreboard players operation @s charger_check -= @s charger_time",
            "event entity @p[family=charger,scores={charger_check=0}] action_clear",
            "scoreboard players reset @e[family=charger,scores={charger_check=0}] charger_time",

            "execute @s[tag=!damaged] ~~~ damage @e[family=player,family=!tool,type=!item,tag=!neutral,r=3.2] 5 suicide",
            "tag @s add damaged",
            "effect @e[family=player,family=!tool,type=!item,tag=!neutral,r=3.2] slowness 4 2 true"
          ]
        },
        "add": {
          "component_groups": [
            "godie"
          ]
        }
      },
      "over_mod": {
        "queue_command": {
          "command": [
            "title @p[family=charger] actionbar §7冲撞结束！",
            "tp @p[family=charger] ^^^1.5",
            "tp @e[tag=charger_get,r=3.2] ^^^1.5",

            "scoreboard players operation @e[family=!charger,family=!tool] charger_check = @s charger_time",
            "execute @e[family=!charger,family=!tool] ~~~ scoreboard players operation @s charger_check -= @s charger_time",
            "tag @e[family=!charger,family=!tool,scores={charger_check=0}] remove charger_get",
            "scoreboard players reset @e[family=!charger,family=!tool,scores={charger_check=0}] charger_time",
            "scoreboard players operation @e[family=charger] charger_check = @s charger_time",
            "execute @e[family=charger] ~~~ scoreboard players operation @s charger_check -= @s charger_time",
            "event entity @p[family=charger,scores={charger_check=0}] action_clear",
            "scoreboard players reset @e[family=charger,scores={charger_check=0}] charger_time",

            "execute @s[tag=!damaged] ~~~ damage @e[family=!charger,family=!tool,r=3.2] 5 suicide",
            "tag @s add damaged",
            "effect @e[family=!charger,family=!tool,r=3.2] slowness 4 2 true"
          ]
        },
        "add": {
          "component_groups": [
            "godie"
          ]
        }
      }
    }
  }
}
